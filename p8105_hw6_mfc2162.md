p8105\_hw6\_mfc2162
================
Madeline Cannon
11/17/2019

``` r
library(tidyverse)
```

    ## -- Attaching packages ------------------------------------------------- tidyverse 1.2.1 --

    ## v ggplot2 3.2.0     v purrr   0.3.2
    ## v tibble  2.1.3     v dplyr   0.8.3
    ## v tidyr   1.0.0     v stringr 1.4.0
    ## v readr   1.3.1     v forcats 0.4.0

    ## -- Conflicts ---------------------------------------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

# Problem 1

## Load and clean data

``` r
birthweight = read_csv("./data/birthweight.csv") %>%
  mutate(babysex = as.factor(recode(babysex, "1" = "male", "2" = "female"))) %>%
  mutate(frace = as.factor(recode(frace, "1" = "White",
                                          "2" = "Black",
                                          "3" = "Asian",
                                          "4" = "Puerto Rican",
                                          "8" = "Other",
                                          "9" = "Unknown"))) %>%
  mutate(frace = relevel(frace, "White")) %>%
  mutate(malform = as.factor(recode(malform, "0" = "absent", "1" = "present"))) %>%
  mutate(mrace = as.factor(recode(mrace, "1" = "White",
                                          "2" = "Black",
                                          "3" = "Asian",
                                          "4" = "Puerto Rican",
                                          "8" = "Other",
                                          "9" = "Unknown"))) %>%
  mutate(mrace = relevel(mrace, "White"))
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_double()
    ## )

    ## See spec(...) for full column specifications.

## Build model

Birthweight is continuous, so I’ll use a linear regression model.

#### Univariate analyses

First I’ll do univariate analyses for each variable. I’ll also plot
continous variables against birthweight to check if the association is
linear and if there are outliers.

``` r
#babysex
fit = lm(bwt ~ babysex, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ babysex, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2533.58  -290.81    21.19   333.19  1722.19 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)  3068.81      11.10 276.378  < 2e-16 ***
    ## babysexmale    88.77      15.49   5.729 1.08e-08 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 510.3 on 4340 degrees of freedom
    ## Multiple R-squared:  0.007507,   Adjusted R-squared:  0.007278 
    ## F-statistic: 32.83 on 1 and 4340 DF,  p-value: 1.076e-08

``` r
#bhead
fit = lm(bwt ~ bhead, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ bhead, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -1334.60  -229.95   -12.73   224.05  2443.47 
    ## 
    ## Coefficients:
    ##              Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) -4830.866    107.427  -44.97   <2e-16 ***
    ## bhead         236.109      3.189   74.05   <2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 340.5 on 4340 degrees of freedom
    ## Multiple R-squared:  0.5582, Adjusted R-squared:  0.5581 
    ## F-statistic:  5483 on 1 and 4340 DF,  p-value: < 2.2e-16

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=bhead, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

``` r
#Remove outlier
birthweight = birthweight %>% filter(!(bwt == 2807 & bhead == 22))

#blength
fit = lm(bwt ~ blength, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ blength, data = birthweight)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -1796.9  -226.5    -5.7   221.3  4516.2 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) -3861.48      95.17  -40.57   <2e-16 ***
    ## blength       140.21       1.91   73.41   <2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 342.1 on 4339 degrees of freedom
    ## Multiple R-squared:  0.5539, Adjusted R-squared:  0.5538 
    ## F-statistic:  5388 on 1 and 4339 DF,  p-value: < 2.2e-16

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=blength, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-2.png)<!-- -->

``` r
#Remove outlier
birthweight = birthweight %>% filter(!(bwt == 3459 & blength == 20))

#delweight
fit = lm(bwt ~ delwt, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ delwt, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2437.20  -286.10    21.99   316.75  1687.08 
    ## 
    ## Coefficients:
    ##              Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 2148.2065    49.3898   43.49   <2e-16 ***
    ## delwt          6.6369     0.3354   19.79   <2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 490.6 on 4338 degrees of freedom
    ## Multiple R-squared:  0.0828, Adjusted R-squared:  0.08259 
    ## F-statistic: 391.6 on 1 and 4338 DF,  p-value: < 2.2e-16

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=delwt, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-3.png)<!-- -->

``` r
#fincome
fit = lm(bwt ~ fincome, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ fincome, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2592.58  -284.58     9.85   336.93  1704.39 
    ## 
    ## Coefficients:
    ##              Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 2979.9075    15.1413  196.81   <2e-16 ***
    ## fincome        3.0486     0.2958   10.31   <2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 506.1 on 4338 degrees of freedom
    ## Multiple R-squared:  0.02391,    Adjusted R-squared:  0.02368 
    ## F-statistic: 106.2 on 1 and 4338 DF,  p-value: < 2.2e-16

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=fincome, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-4.png)<!-- -->

``` r
#frace
fit = lm(bwt ~ frace, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ frace, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2437.64  -284.45    23.56   308.12  1754.12 
    ## 
    ## Coefficients:
    ##                   Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)        3265.44      10.63 307.296  < 2e-16 ***
    ## fraceAsian         -105.71      72.95  -1.449    0.147    
    ## fraceBlack         -313.56      15.44 -20.309  < 2e-16 ***
    ## fraceOther          -88.44     131.26  -0.674    0.500    
    ## fracePuerto Rican  -203.81      32.85  -6.204 6.01e-10 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 489.5 on 4335 degrees of freedom
    ## Multiple R-squared:  0.08758,    Adjusted R-squared:  0.08673 
    ## F-statistic:   104 on 4 and 4335 DF,  p-value: < 2.2e-16

``` r
#gaweeks
fit = lm(bwt ~ gaweeks, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ gaweeks, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -1730.44  -292.52    -0.81   302.48  1591.36 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)  475.674     88.818   5.356 8.97e-08 ***
    ## gaweeks       66.928      2.246  29.804  < 2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 466.7 on 4338 degrees of freedom
    ## Multiple R-squared:   0.17,  Adjusted R-squared:  0.1698 
    ## F-statistic: 888.3 on 1 and 4338 DF,  p-value: < 2.2e-16

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=gaweeks, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-5.png)<!-- -->

``` r
#malform
fit = lm(bwt ~ malform, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ malform, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2519.36  -307.36    18.14   344.64  1676.64 
    ## 
    ## Coefficients:
    ##                Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)     3114.36       7.79 399.808   <2e-16 ***
    ## malformpresent    11.64     132.50   0.088     0.93    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 512.3 on 4338 degrees of freedom
    ## Multiple R-squared:  1.781e-06,  Adjusted R-squared:  -0.0002287 
    ## F-statistic: 0.007724 on 1 and 4338 DF,  p-value: 0.93

``` r
#p > 0.25, don't include in multivariable model

#menarche
fit = lm(bwt ~ menarche, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ menarche, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2523.72  -294.93    19.88   336.47  1672.28 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 3219.478     66.313  48.550   <2e-16 ***
    ## menarche      -8.397      5.262  -1.596    0.111    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 512.1 on 4338 degrees of freedom
    ## Multiple R-squared:  0.0005866,  Adjusted R-squared:  0.0003562 
    ## F-statistic: 2.546 on 1 and 4338 DF,  p-value: 0.1106

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=menarche, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-6.png)<!-- -->

``` r
#Remove impossible observations
birthweight = birthweight %>% filter(!(menarche == 0 | menarche == 5))

#mheight
fit = lm(bwt ~ mheight, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ mheight, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2472.28  -285.91    21.72   327.17  1694.72 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)  756.633    182.625   4.143 3.49e-05 ***
    ## mheight       37.137      2.874  12.923  < 2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 502.7 on 4336 degrees of freedom
    ## Multiple R-squared:  0.03709,    Adjusted R-squared:  0.03686 
    ## F-statistic:   167 on 1 and 4336 DF,  p-value: < 2.2e-16

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=mheight, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-7.png)<!-- -->

``` r
#momage
fit = lm(bwt ~ momage, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ momage, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2514.20  -292.05    19.95   331.95  1717.49 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 2752.280     41.087  66.986   <2e-16 ***
    ## momage        17.846      1.988   8.977   <2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 507.6 on 4336 degrees of freedom
    ## Multiple R-squared:  0.01825,    Adjusted R-squared:  0.01802 
    ## F-statistic: 80.59 on 1 and 4336 DF,  p-value: < 2.2e-16

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=momage, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-8.png)<!-- -->

``` r
#mrace
fit = lm(bwt ~ mrace, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ mrace, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2431.34  -285.44    22.43   309.56  1557.56 
    ## 
    ## Coefficients:
    ##                   Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)        3266.57      10.55 309.482  < 2e-16 ***
    ## mraceAsian         -126.34      75.31  -1.678   0.0935 .  
    ## mraceBlack         -316.13      15.39 -20.542  < 2e-16 ***
    ## mracePuerto Rican  -211.23      33.09  -6.383 1.92e-10 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 489 on 4334 degrees of freedom
    ## Multiple R-squared:  0.08946,    Adjusted R-squared:  0.08883 
    ## F-statistic: 141.9 on 3 and 4334 DF,  p-value: < 2.2e-16

``` r
#parity
fit = lm(bwt ~ parity, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ parity, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2519.69  -307.69    32.31   344.31  1676.31 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)  3114.69       7.78 400.353   <2e-16 ***
    ## parity        -41.71      75.55  -0.552    0.581    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 512.3 on 4336 degrees of freedom
    ## Multiple R-squared:  7.03e-05,   Adjusted R-squared:  -0.0001603 
    ## F-statistic: 0.3049 on 1 and 4336 DF,  p-value: 0.5809

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=parity, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

    ## Warning: Computation failed in `stat_smooth()`:
    ## x has insufficient unique values to support 10 knots: reduce k.

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-9.png)<!-- -->

``` r
#p > 0.25, don't include in multivariable model

#pnumlbw
fit = lm(bwt ~ pnumlbw, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ pnumlbw, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2519.59  -307.59    32.41   344.41  1676.41 
    ## 
    ## Coefficients: (1 not defined because of singularities)
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 3114.590      7.777   400.5   <2e-16 ***
    ## pnumlbw           NA         NA      NA       NA    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 512.2 on 4337 degrees of freedom

``` r
#NA, all observations = 0

#pnumgsa
fit = lm(bwt ~ pnumsga, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ pnumsga, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2519.59  -307.59    32.41   344.41  1676.41 
    ## 
    ## Coefficients: (1 not defined because of singularities)
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 3114.590      7.777   400.5   <2e-16 ***
    ## pnumsga           NA         NA      NA       NA    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 512.2 on 4337 degrees of freedom

``` r
#NA, all observations = 0

#ppbmi
fit = lm(bwt ~ ppbmi, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ ppbmi, data = birthweight)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -2548.3  -294.8    20.2   324.7  1712.5 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 2789.713     53.065  52.572  < 2e-16 ***
    ## ppbmi         15.061      2.434   6.189 6.63e-10 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 510.1 on 4336 degrees of freedom
    ## Multiple R-squared:  0.008755,   Adjusted R-squared:  0.008527 
    ## F-statistic:  38.3 on 1 and 4336 DF,  p-value: 6.635e-10

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=ppbmi, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-10.png)<!-- -->

``` r
#ppwt
fit = lm(bwt ~ ppwt, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ ppwt, data = birthweight)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -2521.9  -289.1    21.0   322.3  1748.3 
    ## 
    ## Coefficients:
    ##              Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 2541.5337    47.4558   53.56   <2e-16 ***
    ## ppwt           4.6405     0.3793   12.23   <2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 503.7 on 4336 degrees of freedom
    ## Multiple R-squared:  0.03337,    Adjusted R-squared:  0.03315 
    ## F-statistic: 149.7 on 1 and 4336 DF,  p-value: < 2.2e-16

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=ppwt, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-11.png)<!-- -->

``` r
#smoken
fit = lm(bwt ~ smoken, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ smoken, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2541.29  -300.44    15.94   326.70  1654.71 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 3136.295      8.888   352.9  < 2e-16 ***
    ## smoken        -5.235      1.047    -5.0 5.95e-07 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 510.8 on 4336 degrees of freedom
    ## Multiple R-squared:  0.005734,   Adjusted R-squared:  0.005504 
    ## F-statistic:    25 on 1 and 4336 DF,  p-value: 5.947e-07

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=smoken, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-12.png)<!-- -->

``` r
#wtgain
fit = lm(bwt ~ wtgain, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ wtgain, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -2422.00  -297.70    20.94   324.04  1619.58 
    ## 
    ## Coefficients:
    ##              Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 2859.0169    16.9742   168.4   <2e-16 ***
    ## wtgain        11.5704     0.6886    16.8   <2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 496.4 on 4336 degrees of freedom
    ## Multiple R-squared:  0.06114,    Adjusted R-squared:  0.06092 
    ## F-statistic: 282.4 on 1 and 4336 DF,  p-value: < 2.2e-16

``` r
#Check for linearity and outliers
ggplot(data=birthweight, aes(x=wtgain, y=bwt)) + geom_point() + geom_smooth()
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_mfc2162_files/figure-gfm/unnamed-chunk-3-13.png)<!-- -->

#### Multivariable model building

I will exclude malform and parity from the model because their p-values
were \> 0.25 in the univariate analyses. pnumlbw and pnumsgsa had the
same value for all observations, so I’ll exclude them as well.

Delivery weight can be calculated directly from pre-pregnancy weight and
weight gain, so these variables will be collinear. Similarly,
pre-pregnancy bmi can be calculated directly from pre-pregnancy weight
and height. To avoid collinearity, I’ll exclude ppwt, wtgain, and
mheight. I’ll keep delwt and ppbmi because they will give the same
information using one degree of freedom each instead of two.

I’ll start with all the other variables and remove them one at a time
based on their p-values until all p-values are \<
0.10.

``` r
fit = lm(bwt ~ babysex + bhead + blength + delwt + fincome + frace + gaweeks + menarche + momage + mrace + ppbmi + smoken, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ babysex + bhead + blength + delwt + fincome + 
    ##     frace + gaweeks + menarche + momage + mrace + ppbmi + smoken, 
    ##     data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -1146.57  -181.48    -2.53   175.15  1437.29 
    ## 
    ## Coefficients:
    ##                     Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)       -5735.6684   107.0854 -53.562  < 2e-16 ***
    ## babysexmale         -30.5887     8.3287  -3.673 0.000243 ***
    ## bhead               129.9525     3.4432  37.742  < 2e-16 ***
    ## blength              79.0307     2.0462  38.623  < 2e-16 ***
    ## delwt                 3.5417     0.2805  12.626  < 2e-16 ***
    ## fincome               0.3087     0.1763   1.751 0.080095 .  
    ## fraceAsian           22.7360    68.2299   0.333 0.738979    
    ## fraceBlack           17.2865    45.4400   0.380 0.703649    
    ## fraceOther           10.0148    72.9274   0.137 0.890780    
    ## fracePuerto Rican   -45.9315    43.9877  -1.044 0.296456    
    ## gaweeks              10.5214     1.4368   7.323 2.88e-13 ***
    ## menarche             -3.2498     2.8775  -1.129 0.258795    
    ## momage                0.7141     1.1928   0.599 0.549402    
    ## mraceAsian          -90.6982    70.7721  -1.282 0.200068    
    ## mraceBlack         -149.6716    45.3363  -3.301 0.000970 ***
    ## mracePuerto Rican   -50.6782    44.3938  -1.142 0.253700    
    ## ppbmi               -12.7251     1.9077  -6.670 2.87e-11 ***
    ## smoken               -4.6225     0.5784  -7.991 1.70e-15 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 268.3 on 4320 degrees of freedom
    ## Multiple R-squared:  0.7267, Adjusted R-squared:  0.7257 
    ## F-statistic: 675.8 on 17 and 4320 DF,  p-value: < 2.2e-16

``` r
#Remove momage
fit = lm(bwt ~ babysex + bhead + blength + delwt + fincome + frace + gaweeks + menarche + mrace + ppbmi + smoken, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ babysex + bhead + blength + delwt + fincome + 
    ##     frace + gaweeks + menarche + mrace + ppbmi + smoken, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -1146.79  -180.84    -2.88   175.11  1437.77 
    ## 
    ## Coefficients:
    ##                     Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)       -5729.4856   106.5784 -53.758  < 2e-16 ***
    ## babysexmale         -30.4672     8.3256  -3.659 0.000256 ***
    ## bhead               129.9645     3.4429  37.749  < 2e-16 ***
    ## blength              79.0173     2.0459  38.622  < 2e-16 ***
    ## delwt                 3.5398     0.2805  12.621  < 2e-16 ***
    ## fincome               0.3322     0.1719   1.932 0.053368 .  
    ## fraceAsian           23.8456    68.1996   0.350 0.726623    
    ## fraceBlack           16.6330    45.4236   0.366 0.714252    
    ## fraceOther            9.2112    72.9096   0.126 0.899471    
    ## fracePuerto Rican   -46.0286    43.9841  -1.046 0.295397    
    ## gaweeks              10.5578     1.4354   7.355 2.27e-13 ***
    ## menarche             -2.9081     2.8201  -1.031 0.302505    
    ## mraceAsian          -88.7358    70.6909  -1.255 0.209451    
    ## mraceBlack         -150.5018    45.3117  -3.321 0.000903 ***
    ## mracePuerto Rican   -51.4502    44.3718  -1.160 0.246306    
    ## ppbmi               -12.5988     1.8958  -6.646 3.40e-11 ***
    ## smoken               -4.6246     0.5784  -7.996 1.64e-15 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 268.3 on 4321 degrees of freedom
    ## Multiple R-squared:  0.7267, Adjusted R-squared:  0.7257 
    ## F-statistic: 718.2 on 16 and 4321 DF,  p-value: < 2.2e-16

``` r
#Remove menarche
fit = lm(bwt ~ babysex + bhead + blength + delwt + fincome + frace + gaweeks + mrace + ppbmi + smoken, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ babysex + bhead + blength + delwt + fincome + 
    ##     frace + gaweeks + mrace + ppbmi + smoken, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -1148.62  -181.79    -3.36   175.73  1431.91 
    ## 
    ## Coefficients:
    ##                     Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)       -5769.5344    99.2510 -58.131  < 2e-16 ***
    ## babysexmale         -30.4819     8.3257  -3.661 0.000254 ***
    ## bhead               129.8815     3.4419  37.735  < 2e-16 ***
    ## blength              79.0838     2.0449  38.673  < 2e-16 ***
    ## delwt                 3.5374     0.2805  12.613  < 2e-16 ***
    ## fincome               0.3334     0.1719   1.940 0.052466 .  
    ## fraceAsian           22.5545    68.1887   0.331 0.740837    
    ## fraceBlack           15.6366    45.4136   0.344 0.730626    
    ## fraceOther            8.8831    72.9095   0.122 0.903034    
    ## fracePuerto Rican   -47.4916    43.9616  -1.080 0.280070    
    ## gaweeks              10.5540     1.4354   7.353 2.31e-13 ***
    ## mraceAsian          -90.4798    70.6712  -1.280 0.200511    
    ## mraceBlack         -149.5619    45.3028  -3.301 0.000970 ***
    ## mracePuerto Rican   -50.2806    44.3576  -1.134 0.257055    
    ## ppbmi               -12.4270     1.8885  -6.580 5.25e-11 ***
    ## smoken               -4.6371     0.5783  -8.019 1.36e-15 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 268.3 on 4322 degrees of freedom
    ## Multiple R-squared:  0.7267, Adjusted R-squared:  0.7257 
    ## F-statistic:   766 on 15 and 4322 DF,  p-value: < 2.2e-16

``` r
#Remove frace
fit = lm(bwt ~ babysex + bhead + blength + delwt + fincome + gaweeks + mrace + ppbmi + smoken, data = birthweight)
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ babysex + bhead + blength + delwt + fincome + 
    ##     gaweeks + mrace + ppbmi + smoken, data = birthweight)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -1147.91  -182.01    -3.06   176.03  1431.35 
    ## 
    ## Coefficients:
    ##                     Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)       -5768.9055    99.1563 -58.180  < 2e-16 ***
    ## babysexmale         -30.4577     8.3230  -3.659 0.000256 ***
    ## bhead               129.9010     3.4396  37.767  < 2e-16 ***
    ## blength              79.0401     2.0438  38.673  < 2e-16 ***
    ## delwt                 3.5413     0.2801  12.643  < 2e-16 ***
    ## fincome               0.3332     0.1715   1.943 0.052029 .  
    ## gaweeks              10.5680     1.4350   7.365 2.11e-13 ***
    ## mraceAsian          -71.8893    41.6608  -1.726 0.084493 .  
    ## mraceBlack         -134.0746     9.7642 -13.731  < 2e-16 ***
    ## mracePuerto Rican   -93.5024    18.8300  -4.966 7.11e-07 ***
    ## ppbmi               -12.4496     1.8875  -6.596 4.74e-11 ***
    ## smoken               -4.6102     0.5773  -7.986 1.77e-15 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 268.2 on 4326 degrees of freedom
    ## Multiple R-squared:  0.7265, Adjusted R-squared:  0.7258 
    ## F-statistic:  1045 on 11 and 4326 DF,  p-value: < 2.2e-16

The final model includes baby’s sex, baby’s head circumference, baby’s
length, mother’s delivery weight, family income, gestational age,
mother’s race, mother’s pre-pregnancy BMI, and average number of
cigarettes smoked per day.
